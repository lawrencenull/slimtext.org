(function(){var e;window.editor=ace.edit("editor"),e=document.getElementById("file_manager"),window.save_file=function(){var n;return window.storage.file?(n=e.write(window.storage.file,editor.getValue()),n?(window.notice(chrome.i18n.getMessage("saved"),window.storage.file),document.title=""+e.filename(window.storage.file)+" - Slim Text"):alert(""+chrome.i18n.getMessage("unable_to_save")+" "+window.storage.file)):void 0},window.show_breadcrumb=function(n){var o,t,a,s,i,r,l,d,p,c,g,u,w;if($("#route").empty(),r=e.route(n),r.reverse(),-1!==navigator.appVersion.indexOf("Windows")){if(a=_.first(r),r=_.rest(r),l=_.first(r),l&&(l.name=a.name),0===r.length){for(t=$('<select id="drives_select"></select>'),u=e.drives(),d=0,c=u.length;c>d;d++)o=u[d],t.append('<option value="'+o+'">'+o.substr(0,o.length-1)+"</option>");t.val(a.name+"/"),$("#route").append(t)}}else 0===r.length&&$("#route").append("/");for(w=_.initial(r),p=0,g=w.length;g>p;p++)s=w[p],i=$('<a class="file-link">'+s.name+"</a>"),i.data("path",s.path),$("#route").append(i),"/"===s.name?$("#route").append(" "):$("#route").append(" / ");return s=_.last(r),s?$("#route").append(""+s.name):void 0},window.show_sidebar=function(n){var o,t,a,s,i,r;for($("#sidebar").empty(),t=e.list(n),t=_.filter(t,function(n){var o;if("folder"===n.type)return!0;if("file"===n.type){if(o=e.extension(n.name),""===o)return!0;if(o===n.name)return!0;if(o=o.toLowerCase().substr(1,o.length-1),window.known_extension(o))return!0}return!1}),t=_.sortBy(t,function(e){return e.name.toLowerCase()}),r=[],s=0,i=t.length;i>s;s++)o=t[s],o.path===window.storage.file?$("#sidebar").append(o.name):(a=$('<a class="file-link">'+o.name+"</a>"),a.data("path",o.path),$("#sidebar").append(a),"folder"===o.type&&$("#sidebar").append("/")),r.push($("#sidebar").append("<br/>"));return r},window.add_topbar=function(){var e,n,o,t,a,s,i,r,l,d,p,c;for($(".ui-layout-resizer-north").append('<div id="navbar">\n  <span class="dropdown">\n    <a class="dropdown-toggle" data-toggle="dropdown">\n      '+chrome.i18n.getMessage("file")+'\n      <b class="caret"></b>\n    </a>\n    <ul class="dropdown-menu">\n        <li><a class="save_btn">'+chrome.i18n.getMessage("save")+'</a></li>\n    </ul>\n  </span>\n  <span class="dropdown">\n    <a class="dropdown-toggle" data-toggle="dropdown">\n      '+chrome.i18n.getMessage("edit")+'\n      <b class="caret"></b>\n    </a>\n    <ul class="dropdown-menu">\n        <li><a class="lower_case_btn">'+chrome.i18n.getMessage("lower_case")+'</a></li>\n        <li><a class="upper_case_btn">'+chrome.i18n.getMessage("upper_case")+'</a></li>\n        <li><a class="remove_lines_btn">'+chrome.i18n.getMessage("remove_lines")+'</a></li>\n    </ul>\n  </span>\n  <span class="dropdown">\n    <a class="dropdown-toggle" data-toggle="dropdown">\n      '+chrome.i18n.getMessage("view")+'\n      <b class="caret"></b>\n    </a>\n    <ul class="dropdown-menu">\n        <li class="dropdown-submenu">\n            <a>'+chrome.i18n.getMessage("syntax")+'</a>\n            <ul class="dropdown-menu" id="mode_list"></ul>\n        </li>\n        <li><a class="full_window_btn">'+chrome.i18n.getMessage("full_window")+'</a></li>\n    </ul>\n  </span>\n  <span class="dropdown">\n    <a class="dropdown-toggle" data-toggle="dropdown">\n      '+chrome.i18n.getMessage("preferences")+'\n      <b class="caret"></b>\n    </a>\n    <ul class="dropdown-menu">\n        <li><a class="options_btn">'+chrome.i18n.getMessage("options")+'</a></li>\n    </ul>\n  </span>\n  <span class="dropdown">\n    <a class="dropdown-toggle" data-toggle="dropdown">\n      '+chrome.i18n.getMessage("help")+'\n      <b class="caret"></b>\n    </a>\n    <ul class="dropdown-menu">\n        <li><a href="https://github.com/ajaxorg/ace/wiki/Default-Keyboard-Shortcuts" target="_blank">'+chrome.i18n.getMessage("keyboard_shortcuts")+'</a></li>\n        <li><a href="http://slimtext.org" target="_blank">'+chrome.i18n.getMessage("website")+'</a></li>\n        <li><a href="https://github.com/tylerlong/slimtext.org/issues" target="_blank">'+chrome.i18n.getMessage("report_issue")+'</a></li>\n        <li><a class="about_btn">'+chrome.i18n.getMessage("about")+' Slim Text</a></li>\n    </ul>\n  </span>\n</div>\n<div id="toolbar">\n<a class="save_btn" title="'+chrome.i18n.getMessage("save")+'"><i class="icon-save"></i></a>\n<a class="full_window_btn" title="'+chrome.i18n.getMessage("full_window")+'"><i class="icon-fullscreen"></i></a>\n<i class="icon-fullscreen" id="hidden_btn"></i>\n</div>'),i=[["a","d"],["e","j"],["k","o"],["p","s"],["t","z"]],a=[],r=0,d=i.length;d>r;r++)s=i[r],$("#mode_list").append('<li class="dropdown-submenu">\n    <a>'+s[0].toUpperCase()+" - "+s[1].toUpperCase()+'</a>\n    <ul class="dropdown-menu" id="'+s[0]+"_to_"+s[1]+'"></ul>\n</li>'),a.push([RegExp("^["+s[0]+"-"+s[1]+"]","i"),"#"+s[0]+"_to_"+s[1]]);c=window.modes;for(n in c)for(o=c[n],e='<li><a data-mode="'+n+'" class="mode-link">'+o+"</a></li>",l=0,p=a.length;p>l;l++)if(t=a[l],o.match(t[0])){$(t[1]).append(e);break}return window.layout.allowOverflow($(".ui-layout-resizer-north")),window.layout.state.north.isClosed?($("#navbar").hide(),$("#toolbar").hide()):void 0},window.open_path=function(n){var o,t,a,s,i,r,l,d;{if(e.exists(n)){if(i=e.type(n),"file"===i){if(0===document.title.indexOf("* ")&&!confirm('"'+window.storage.file+'" '+chrome.i18n.getMessage("save_before_leaving")))return;window.storage.file=n,o=e.read(n),editor.session.setValue(o,-1),t=e.extension(n),t&&(t=t.toLowerCase().substr(1,t.length-1)),editor.getSession().setMode(window.guess_mode(t)),document.title=""+e.filename(n)+" - Slim Text",n=e.container(n)}for(;!e.can_list(n);)window.notice(chrome.i18n.getMessage("permission_denied"),n),n=e.container(n);return window.storage.path=n,show_breadcrumb(n),show_sidebar(n)}for(window.notice(chrome.i18n.getMessage("does_not_exist"),n),s=e.route(n),d=_.rest(s),r=0,l=d.length;l>r;r++)if(a=d[r],e.exists(a.path))return window.open_path(a.path),void 0}},$(function(){return chrome.storage.local.get(["path","file"],function(n){var o;return o=n.file||n.path||e.home_folder()||e.temp_folder(),window.storage={file:n.file,path:o},open_path(o),o=n.path||e.home_folder()||e.temp_folder(),open_path(o)}),chrome.storage.sync.get(["theme","font_size"],function(e){return e.theme||(e.theme="monokai"),e.font_size||(e.font_size="12"),editor.setTheme("ace/theme/"+e.theme),editor.setFontSize(""+e.font_size+"px")}),window.layout=$("body").layout({spacing_closed:5,stateManagement__enabled:!0,north:{slidable:!1,spacing_open:14,size:18,resizable:!1,togglerLength_open:0,togglerTip_closed:"Exit full window",onopen_start:function(){return window.layout.open("west"),$("#navbar").show(),$("#toolbar").show()},onclose_start:function(){return $("#navbar").hide(),$("#toolbar").hide()}},west:{spacing_open:5,livePaneResizing:!0,size:128,togglerLength_open:0,togglerLength_closed:0,slideTrigger_open:"mouseover"},center:{onresize_end:function(){return editor.resize()}}}),window.add_topbar()})}).call(this);